package com.example;

import java.util.*;

public class tspSolver {

    //Declaring the values given
    private String[] source = {"St. Peter", "St. John", "Lanao", "Maguindanao"};

    private int[][] distance = {
        {0, 300, 150, 200},
        {150, 0, 200, 300}, 
        {100, 120, 0, 200}, 
        {200, 200, 100, 0}
    };

    private String[] shortestPath;
    private int minDistance;

    //Method to solve TSP
    public void solveTSP(String startingPoint) {
        //Initializing of variables
        shortestPath = null;
        minDistance = Integer.MAX_VALUE;

        // Calls permute() method to create all possible permutations
        ArrayList<String[]> permutation = permute(source);

        // Iterates over each permutation generated (Loop)
        for (String[] p : permutation) {
            // Initializes totalDistance
            int totalDistance = 0;

            // Finding index of starting point
            int startIndex = getIndex(startingPoint);

            // Starting from the specified starting point
            totalDistance += distance[startIndex][getIndex(p[0])];

            for (int i = 0; i < p.length - 1; i++) {
                int fromIndex = getIndex(p[i]);
                int toIndex = getIndex(p[i + 1]);

                totalDistance += distance[fromIndex][toIndex];
            }

            totalDistance += distance[getIndex(p[p.length - 1])][startIndex];

            // Print out all possible permutations
            if (startingPoint.equals(p[0])) {
                for (String location : p) {
                    System.out.print(location + " -> ");
                }
                System.out.println(p[0]); // Prints the starting point of each corresponding permutation
                System.out.println("Distance: " + totalDistance);
                System.out.println();
            }

            // Updating shortest path and distance if the current path is shorter
            if (totalDistance < minDistance && startingPoint.equals(p[0])) {
                minDistance = totalDistance;
                shortestPath = p;
            }
        }

        // Print optimal path and distance
        System.out.print("Shortest Path: ");
        for (String location : shortestPath) {
            System.out.print(location + " -> ");
        }
        System.out.println(shortestPath[0]); // Prints out the starting point of the shortest path
        System.out.println("Distance: " + minDistance);
    }

    // Method to generate all possible permutations
    private ArrayList<String[]> permute(String[] source) {
        // Initializes list to store the permutations
        ArrayList<String[]> permutation = new ArrayList<>();

        // Recursive method to generate permutations
        permuteSolve(source, 0, permutation);

        return permutation;
    }

    // Recursive method to generate permutations
    private void permuteSolve(String[] source, int index, ArrayList<String[]> permutation) {
        // If index reaches the length of source array, adds the current permutation to the list
        if (index == source.length - 1) {
            String[] permutations = source.clone(); // clone() method makes the copy of the data itself
            permutation.add(permutations);
        } else {
            for (int i = index; i < source.length; i++) {
                swap(source, index, i); // Swapping elements
                permuteSolve(source, index + 1, permutation); // Recursive permutation
                swap(source, index, i); // Maintaining original array for next permutations
            }
        }
    }

    // Method to swap elements in array
    private void swap(String[] source, int x, int y) {
        String temp = source[x];
        source[x] = source[y];
        source[y] = temp;
    }

    // Method to get the indices of location in source array
    private int getIndex(String location) {
        for (int i = 0; i < source.length; i++) {
            if (source[i].equals(location)) {
                return i;
            }
        }
        return -1; // Default; or not found
    }

    public static void main(String[] args) {
        tspSolver tsp = new tspSolver();

        Scanner sc = new Scanner(System.in);      

        System.out.println("St. Peter\n" +
                           "St. John\n" +
                           "Lanao\n" +
                           "Maguindanao\n\n");;
        
        System.out.print("Choose your starting point: ");
        String location = sc.nextLine();
        System.out.println();
        
        tsp.solveTSP(location); // Example: Starting point is "St. Peter"
    }
}
